<html lang="en" xmlns="http://www.w3.org/1999/html"><head>
    <meta charset="UTF-8">
    <title>Task page</title>

    <link rel="stylesheet" href="/css/bootstrap-select.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="/css/style.css">
    <link rel="stylesheet" type="text/css" href="/css/sidebar-styles.css">
    <link rel="stylesheet" type="text/css" href="/css/dropDownButton.css">

    <script src="/js/jquery-3.5.1.min.js" crossorigin="anonymous"></script>
    <script src="/js/popper.min.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="/css/bootstrap.min.css" crossorigin="anonymous">
    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="/css/font-awesome.min.css" crossorigin="anonymous">

    <script src="/js/bootstrap.min.js" crossorigin="anonymous"></script>
    <script src="/js/bootstrap-select.min.js"></script>

    <!-- Custom application javascript -->
    <script src="/js/app.js"></script>

    <!-- Language management javascript -->
    <script src="/js/lang-change.js"></script>

    <link rel="shortcut icon" href="/img/foxminded_3232.png">
</head>

<body class="pd-t-71">

<div class="fixed-top">

    <header name="header" style="background-color: rgb(254,254,253);">
    <div class="container">
        <div class="row">
            <nav class="col-12 navbar-expand-lg navbar navbar-light border-bottom">
                <a class="navbar-brand" href="/"><h4 class="text-dark-red">SKARB NGO</h4></a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse ml-5" id="navbarNav">

                    <ul class="navbar-nav">

                        <!-- Main -->
                        <li class="nav-item">
                            <a class="nav-link" href="/">
                                <h5 class="text-dark-red">Main</h5></a>
                        </li>

                        <!-- About -->
                        <li class="nav-item dropdown ml-5">
                            <h5 class="nav-link text-dark-red text-nowrap" id="aboutDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span>About project</span> <i class="fa fa-chevron-down" aria-hidden="true"></i>
                            </h5>
                            <div class="dropdown-menu" aria-labelledby="aboutDropdown">
                                <a class="dropdown-item text-dark-red font-weight-bold link" href="/static/about">About us</a>
                                <a class="dropdown-item text-dark-red font-weight-bold link" href="/news">News</a>
                                <a class="dropdown-item text-dark-red font-weight-bold link" href="/static/rules">Rules</a>
                                <a class="dropdown-item text-dark-red font-weight-bold link" href="/static/help">Help</a>
                                <a class="dropdown-item text-dark-red font-weight-bold  link">Contacts</a>
                            </div>
                        </li>

                        <!-- Members -->
                        <li class="nav-item dropdown ml-5">
                            <h5 class="nav-link text-dark-red text-nowrap" id="membersDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span>Members</span> <i class="fa fa-chevron-down" aria-hidden="true"></i>
                            </h5>
                            <div id="membersContainer" class="dropdown-menu" aria-labelledby="membersDropdown">
                                <a class="dropdown-item text-dark-red font-weight-bold link" href="/info/volunteers">Volunteers</a>
                                <a class="dropdown-item text-dark-red font-weight-bold link" href="/info/organizations/ngo">Organizations</a>
                                <a class="dropdown-item text-dark-red font-weight-bold link" href="/info/organizations/partners">Partners</a>
                            </div>
                        </li>

                        <!-- Tasks -->
                        <li class="nav-item dropdown ml-5">
                            <h5 class="nav-link text-dark-red text-nowrap" id="tasksDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span>Tasks</span> <i class="fa fa-chevron-down" aria-hidden="true"></i>
                            </h5>
                            <div id="tasksContainer" class="dropdown-menu" aria-labelledby="tasksDropdown">
                                <a class="dropdown-item text-dark-red font-weight-bold link" href="/tasks/partner/search/criteria">For partners</a>
                                <a class="dropdown-item text-dark-red font-weight-bold link" href="/tasks/volunteer/search/criteria">For volunteers</a>
                                <a class="dropdown-item text-dark-red font-weight-bold link" href="/tasks/register/volunteer">Create volunteer task</a>
                                
                            </div>
                        </li>

                        <!-- Success Stories -->
                        <li class="nav-item">
                            <a class="nav-link" href="/stories/search/criteria">
                                <h5 class="text-dark-red">Success stories</h5></a>
                        </li>

                        <!-- Language link -->
                        <li class="nav-item dropdown ml-5">
                            <h5 id="langDropdown" class="nav-link text-dark-red" role="button" data-toggle="dropdown" aria-expanded="false">
                                <i class="fa fa-language fa-lg" aria-hidden="true"></i>
                            </h5>
                            <div class="dropdown-menu" aria-labelledby="langDropdown">
                                <a class="dropdown-item link text-dark-red font-weight-bold changeLang" data-lang="en">EN</a>
                                <a class="dropdown-item link text-dark-red font-weight-bold changeLang" data-lang="ru">RU</a>
                                <a class="dropdown-item link text-dark-red font-weight-bold changeLang" data-lang="uk">UA</a>
                            </div>
                        </li>

                    </ul>

                    <!-- User profile link -->
                    <a class="nav-link ml-auto" href="/profile">
                        <i class="fa fa-user-circle-o fa-3x text-dark-red" aria-hidden="true"></i>
                    </a>

                    <!-- Registration link -->
                    

                    <!-- Login link -->
                    


                    <!-- Logout link -->
                    <a class="nav-link" href="/logout">
                        <i class="fa fa-sign-out fa-3x text-dark-red" aria-hidden="true"></i>
                    </a>

                </div>
            </nav>
        </div>
    </div>
</header>

</div>

<div id="content" class="container pd-b-127">
    <!-- Information message alerts -->
    <div id="successMsgAlert" class="row alert alert-success alert-dismissible fade show" role="alert">
        <h4>New task has been successfully registered. </h4>
        <button type="button" class="close alertCloseBtn" aria-label="Close">
            <span aria-hidden="true">×</span>
        </button>
    </div>
    <div id="errorMsgAlert" class="row alert alert-danger alert-dismissible fade show d-none" role="alert">
        <h4></h4>
        <button type="button" class="close alertCloseBtn" aria-label="Close">
            <span aria-hidden="true">×</span>
        </button>
    </div>

    <!-- Card fragment -->
    <div id="taskCardContainer" class="mb-5">

    <!-- Card header -->
    <div name="card-header" class="row">
        <!-- Task name -->
        <div name="task-name" class="col-md-9">
            <h3 class="text-dark-red">
                <span>njgissev</span>
            </h3>
        </div>

        
            <!-- Edit button -->
            <div class="col-md-3">
                <a href="/tasks/edit/volunteer/410/1739" class="btn btn-danger rounded-pill">Edit task</a>
            </div>
        

        
    </div>

    <div class="row mt-4">
        <!-- Left panel content -->
        <div class="col-md-9">
            <!-- Task description-->
            <div name="task-description">lqzagiaifkqxjhjfilfz</div>

            <!-- Task expected outcome-->
            <h4 class="mt-5 text-purple"><span>Work results</span>:</h4>
            <div name="expected-outcome">vyklvwuqxc</div>

            <!-- Task volunteer benefit-->
            <h4 class="mt-5 text-purple"><span>Volunteer benefit</span>:</h4>
            <div name="volunteer-benefit">sxdleocvay</div>

            <!-- Task volunteer requirements-->
            
            <div name="volunteer-requirements">
                <ul>
                    
                </ul>
            </div>
        </div>
        <!-- Right panel content -->
        <div class="col-md-3 bg-light-green py-3">
            <!-- Categories-->
            <h4 class="text-dark-green"><span>Task in categories</span>:</h4>
            <div name="categories">
                <span class="btn badge-pill btn-sm btn-outline-success mr-3 mt-3">Soft drinks</span>
            </div>

            <!-- Task author-->
            <h4 class="mt-5 text-dark-green"><span>Task author</span>:</h4>
            <div name="task-author">
                <a href="/ngos/410" class="text-black">
                    <span>org-1</span>
                </a>
                <br>
                <span class="text-muted">Testname</span>&nbsp;
                <span class="text-muted">Testlastname</span>
            </div>

            <!-- Task deadline-->
            <h4 class="mt-5 text-dark-green"><span>Actual until</span>:</h4>
            <div name="task-deadline">
                <span>08.08.2023</span>
            </div>

            <!-- Task duration-->
            <h4 class="mt-5 text-dark-green"><span>Task duration</span>:</h4>
            <div name="task-duration">
                <span>Up to month</span>
            </div>

            <!-- Saved money -->
            <h4 class="mt-5 text-dark-green">Help to save</h4>
            <div name="saved-money">
                <span>10,00</span>&nbsp;
                <span>dollars</span>
            </div>
        </div>
    </div>

    <!-- Task stages -->
    <h4 class="col-4 offset-4 text-center text-dark-red mt-5 mb-5">
        <span class="font-weight-bold link collapseChevrons" data-toggle="collapse" data-target="#stagesCollapse" aria-expanded="false" aria-controls="stagesCollapse">
            <span>Task stages</span>
            <i class="fa fa-chevron-up d-none" aria-hidden="true"></i>
            <i class="fa fa-chevron-down" aria-hidden="true"></i>
        </span>
    </h4>

    <div name="task-stages" class="collapse" id="stagesCollapse">
        <div name="stage" class="row mt-5">
            <div class="col-3  text-purple">
                <h5 class="d-inline font-weight-bolder">Stage</h5>&nbsp;
                <h5 class="d-inline font-weight-bolder">1</h5>
            </div>

            <div class="col-3">Утверждение плана работы</div>

            <div name="stage-duration" class="col-3">
            <span>Stage duration</span>: <span>20</span>&nbsp;
                <span>days</span>
            </div>

            <div class="col-3 text-center">
                
                    <button class="btn rounded-pill btn-purple">Start again</button>
                
            </div>
        </div>
        <div name="stage" class="row mt-5">
            <div class="col-3  text-purple">
                <h5 class="d-inline font-weight-bolder">Stage</h5>&nbsp;
                <h5 class="d-inline font-weight-bolder">2</h5>
            </div>

            <div class="col-3">Сдача финальных файлов</div>

            <div name="stage-duration" class="col-3">
            <span>Stage duration</span>: <span>10</span>&nbsp;
                <span>days</span>
            </div>

            <div class="col-3 text-center">
                
                    <button class="btn rounded-pill btn-purple">Start again</button>
                
            </div>
        </div>
    </div>

    <!-- Volunteers (performers, responded, candidates) -->
    <div name="performers-block" id="allPerformersContainer" class="row mt-5 pt-3 pb-5 bg-light-green">
        <h4 class="col-12 text-center text-danger font-weight-bolder">
            <span>Volunteers</span>:
        </h4>

        <div class="col-12 mt-3">

            <div class="col-12">

                <!-- Performers row -->
                <div name="performers-row" id="performersContainerParent" class="row mt-4">
                    <div class="col-3 float-left">
                        <h5 class="text-purple">
                            <span class="font-weight-bold link collapseChevrons" data-toggle="collapse" data-target="#performersContainer" aria-expanded="false" aria-controls="stagesCollapse">
                                <span>Performers</span>:
                                <i class="fa fa-chevron-up d-none" aria-hidden="true"></i>
                                <i class="fa fa-chevron-down" aria-hidden="true"></i>
                            </span>
                        </h5>
                    </div>

                    <div name="performers-container" id="performersContainer" class="collapse col-9">
                        
                    </div>

                </div>

                <!-- Responded users row -->
                <div name="responded-users-row" id="respondedContainerParent" class="row mt-4 pt-5">
                    <div class="col-3 float-left">
                        <h5 class="text-purple">
                            <span class="font-weight-bold link collapseChevrons" data-toggle="collapse" data-target="#respondedContainer" aria-expanded="false" aria-controls="stagesCollapse">
                                <span>Responded</span>:
                                <i class="fa fa-chevron-up d-none" aria-hidden="true"></i>
                                <i class="fa fa-chevron-down" aria-hidden="true"></i>
                            </span>
                        </h5>
                    </div>

                    <div name="responded-container" id="respondedContainer" class="collapse col-9">
                        
                    </div>

                </div>

                <!-- Candidate performers row -->
                <div name="candidate-performers-row" id="candidatesContainerParent" class="row mt-4 pt-5">
                    <div class="col-3 float-left">
                        <h5 class="text-purple">
                            <span class="font-weight-bold link collapseChevrons" data-toggle="collapse" data-target="#candidatesContainer" aria-expanded="false" aria-controls="stagesCollapse">
                                <span>Potential performers</span>:
                                <i class="fa fa-chevron-up d-none" aria-hidden="true"></i>
                                <i class="fa fa-chevron-down" aria-hidden="true"></i>
                            </span>
                        </h5>
                    </div>

                    <div name="candidate-container" id="candidatesContainer" class="collapse col-9">
                        
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div name="comments-container" style="background: url('/img/Puzzle1.png') no-repeat;display: block;" class="row mt-5 mb-5 p-3">
        <h4 class="text-center text-dark-red font-weight-bolder mt-5"><span>Comments</span>:</h4>
        <p class="text-center">Here you can clarify the details of the problem and chat with the author</p>
        <div name="comments">
    
</div>
        <div name="comment-form">
    <div class="ml-5 mr-5">
        
        
        <form id="commentForm" action="/comment" method="post">
            <input id="commentEntity" type="hidden" name="entity" value="VOLUNTEER_TASK">
            <input id="commentId" type="hidden" name="id" value="1739">
            <input id="commentParentId" type="hidden" name="parentId" value="">

            <div class="form-group">
                <label for="commentFormContent">Write your comment:</label>
                <textarea id="commentFormContent" name="content" class="form-control"></textarea>
                
            </div>

            <input type="submit" class="btn btn-success" value="Send">
            <input type="reset" class="btn btn-dark" value="Cancel">
        </form>
    </div>
</div>
        <div name="comment-assets">
    <style>
        .comment-avatar {
            width: 46px;
            height: 46px;
            border-radius: 50%;
            border: 5px solid white;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
        }
    </style>
    <script>
        function commentReply(id, userFirstName, userLastName) {
            let quoteComment = userFirstName + " " + userLastName + ":\n" + document.getElementById(id).textContent;
            document.getElementById("commentFormContent").value = addQuotePrefix(quoteComment) + "\n";
            document.getElementById("commentParentId").value = id;
        }

        function addQuotePrefix(string) {
            let tempString = string.split('\n'),
                resultString = [];

            for (const line of tempString) {
                resultString.push(`>> ${line}`);
            }

            return resultString.join('\n');
        }

    </script>
</div>
    </div>
</div>

    <!-- Common actions script -->
    <script>

    let toggleCollapseChevrons = function () {
        let targetBtn = $(this);

        targetBtn.find('i.fa').each(function () {
            let chevron = $(this);
            chevron.toggleClass('d-none')
        });
    }

    let initCommonActions = function () {
        $('.collapseChevrons').on('click', toggleCollapseChevrons);
    };

    $(function () {
        initCommonActions();
    });
</script>

    <!-- Task respond confirmation modal -->
    <div class="modal fade" id="taskRespondModal" tabindex="-1" aria-labelledby="confirmationModal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="exampleModalLabel">Confirm action</h4>
                <button type="button" class="close modalCloseBtn" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <h5>Are you sure you want to respond to this task?</h5>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <a class="btn btn-primary confirmBtn">Confirm</a>
            </div>
        </div>
    </div>
</div>

    <!-- Task respond manage script -->
    <script>

    let taskRespondSuccessMsg = "You successfully responded to this task. Wait for the author respond.";

    let taskRespondFailureMsg = "Something went wrong. Maybe you already responded to this task?";

    let sendTaskRespondRequest = function () {
        let successMsgAlert = $('#successMsgAlert');
        let errorMsgAlert = $('#errorMsgAlert');

        let taskRespondBtn = $('button#taskRespondBtn');
        let targetUrl = taskRespondBtn.attr('data-target-url');
        let modalCloseBtn = $('#taskRespondModal button.modalCloseBtn');
        let respondedContainer = $('#respondedContainer');

        $.ajax({
            url: targetUrl,
            type: 'POST',
            success: function (data) {
                let resultHtml = $(data);

                if (resultHtml.hasClass('responded-card')) {
                    taskRespondBtn.addClass('d-none');
                    successMsgAlert.removeClass('d-none');
                    successMsgAlert.find('h4').text(taskRespondSuccessMsg);

                    respondedContainer.append(data);

                    modalCloseBtn.click();
                } else {
                    errorMsgAlert.removeClass('d-none');
                    errorMsgAlert.find('h4').text(taskRespondFailureMsg);

                    modalCloseBtn.click();
                }


            },
            statusCode: {
                400: function () {
                    errorMsgAlert.removeClass('d-none');
                    errorMsgAlert.find('h4').text(taskRespondFailureMsg);

                    modalCloseBtn.click();
                }
            }
        });
    }

    $(function () {

        let init = function () {

            $('#taskRespondModal a.confirmBtn').on('click', sendTaskRespondRequest)
        };

        init();
    });
</script>

    <!-- Task performer confirmation modal -->
    <div class="modal fade" id="taskConfirmationModal" tabindex="-1" aria-labelledby="confirmationModal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="exampleModalLabel">Confirm action</h4>
                <button type="button" class="close modalCloseBtn" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <h5>Are you sure you want to confirm given responded user?</h5>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <a class="btn btn-primary confirmBtn">Confirm</a>
            </div>
        </div>
    </div>
</div>

    <!-- Task performer confirmation manage script -->
    <script>

    let taskConfirmSuccessMsg = "You successfully confirmed new performer for this task.";

    let taskConfirmFailureMsg = "Something went wrong. Maybe this performer is already confirmed?";

    let addTargetCardIdToConfirmationModal = function() {
        let performerConfirmBtn = $(this);
        let targetId= performerConfirmBtn.closest('div.responded-card').attr('id');
        $('#taskConfirmationModal a.confirmBtn').attr('data-target-id', targetId);
    }

    let sendTaskPerformerConfirmationRequest = function () {
        let successMsgAlert = $('#successMsgAlert');
        let errorMsgAlert = $('#errorMsgAlert');

        let modalConfirmBtn = $(this);
        let targetId = modalConfirmBtn.attr('data-target-id');
        let respondedCard = $(`div#${targetId}`)
        let targetUrl = respondedCard.find('button.performerConfirmBtn').attr('data-target-url');
        let modalCloseBtn = $('#taskConfirmationModal button.modalCloseBtn');

        let performersContainer = $('#performersContainer');

        $.ajax({
            url: targetUrl,
            type: 'POST',
            success: function (data) {
                let resultHtml = $(data);

                if (resultHtml.hasClass('performer-card')) {
                    successMsgAlert.removeClass('d-none');
                    successMsgAlert.find('h4').text(taskConfirmSuccessMsg);

                    // remove confirmed performer card from DOM
                    respondedCard.remove();

                    performersContainer.append(data);

                    modalCloseBtn.click();
                } else {
                    errorMsgAlert.removeClass('d-none');
                    errorMsgAlert.find('h4').text(taskConfirmFailureMsg);

                    modalCloseBtn.click();
                }


            },
            statusCode: {
                400: function () {
                    errorMsgAlert.removeClass('d-none');
                    errorMsgAlert.find('h4').text(taskConfirmFailureMsg);

                    modalCloseBtn.click();
                }
            }
        });
    }

    $(function () {

        let init = function () {

            $('div.responded-card button.performerConfirmBtn').on('click', addTargetCardIdToConfirmationModal);

            $('#taskConfirmationModal a.confirmBtn').on('click', sendTaskPerformerConfirmationRequest);
        };

        init();
    });
</script>

    <!-- Task performer rejection modal -->
    <div class="modal fade" id="taskRejectPerformerModal" tabindex="-1" aria-labelledby="confirmationModal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="exampleModalLabel">Confirm action</h4>
                <button type="button" class="close modalCloseBtn" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <h5>Are you sure you want to remove specified user from the task performers?</h5>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <a class="btn btn-primary confirmBtn">Confirm</a>
            </div>
        </div>
    </div>
</div>

    <!-- Task performer rejection manage script -->
    <script>

    let taskPerformerRejectSuccessMsg = "User has been successfully removed from the task performers.";

    let taskPerformerRejectFailureMsg = "Something went wrong. Maybe specified user has already been removed from the task performers?";

    let addPerformerCardIdToConfirmationModal = function() {
        let performerRejectBtn = $(this);
        let targetId = performerRejectBtn.closest('div.performer-card').attr('id');
        $('#taskRejectPerformerModal a.confirmBtn').attr('data-target-id', targetId);
    }

    let sendTaskPerformerRejectionRequest = function () {
        let successMsgAlert = $('#successMsgAlert');
        let errorMsgAlert = $('#errorMsgAlert');

        let modalConfirmBtn = $(this);
        let targetId = modalConfirmBtn.attr('data-target-id');
        let performerCard = $(`div#${targetId}`)
        let targetUrl = performerCard.find('button.performerRejectBtn').attr('data-target-url');
        let modalCloseBtn = $('#taskRejectPerformerModal button.modalCloseBtn');

        $.ajax({
            url: targetUrl,
            type: 'POST',

            statusCode: {
                200: function () {
                    // remove confirmed performer card from DOM
                    performerCard.remove();

                    successMsgAlert.removeClass('d-none');
                    successMsgAlert.find('h4').text(taskPerformerRejectSuccessMsg);

                    modalCloseBtn.click();
                },
                400: function () {
                    errorMsgAlert.removeClass('d-none');
                    errorMsgAlert.find('h4').text(taskPerformerRejectFailureMsg);

                    modalCloseBtn.click();
                }
            }
        });
    }

    $(function () {

        let init = function () {

            $('div.performer-card button.performerRejectBtn').on('click', addPerformerCardIdToConfirmationModal);

            $('#taskRejectPerformerModal a.confirmBtn').on('click', sendTaskPerformerRejectionRequest);
        };

        init();
    });
</script>

    <!-- Task performer invitation modal -->
    <div class="modal fade" id="taskInvitePerformerModal" tabindex="-1" aria-labelledby="confirmationModal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="exampleModalLabel">Confirm action</h4>
                <button type="button" class="close modalCloseBtn" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                <h5>Do you want to invite selected user to become a task performer?</h5>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <a class="btn btn-primary confirmBtn">Confirm</a>
            </div>
        </div>
    </div>
</div>

    <!-- Task performer invitation manage script -->
    <script>

    let taskPerformerInviteSuccessMsg = "The invitation has been sent.";

    let taskPerformerInviteFailureMsg = "Error trying to sent invitation to selected user";

    let addPerformerCardIdToInvitationModal = function() {
        let performerInviteBtn = $(this);
        let targetId = performerInviteBtn.closest('div.candidate-card').attr('id');
        $('#taskInvitePerformerModal a.confirmBtn').attr('data-target-id', targetId);
    }

    let sendTaskPerformerInvitationRequest = function () {
        let successMsgAlert = $('#successMsgAlert');
        let errorMsgAlert = $('#errorMsgAlert');

        let modalConfirmBtn = $(this);
        let targetId = modalConfirmBtn.attr('data-target-id');
        let candidateCard = $(`div#${targetId}`)
        let targetUrl = candidateCard.find('button.performerInviteBtn').attr('data-target-url');
        let modalCloseBtn = $('#taskInvitePerformerModal button.modalCloseBtn');

        $.ajax({
            url: targetUrl,
            type: 'POST',

            success: function (data) {
                let resultHtml = $(data);

                if (resultHtml.hasClass('candidatesContainerFragment')) {
                    $('#candidatesContainer').html(resultHtml.html());

                    successMsgAlert.removeClass('d-none');
                    successMsgAlert.find('h4').text(taskPerformerInviteSuccessMsg);

                    addHandlersToPerformerInviteButtons();
                } else if (resultHtml.hasClass('errorMsgFragment')) {
                    let errorMsgContent = resultHtml.find('#errorMsgContent')
                    errorMsgContent.find('#errorMsgTitle').text(taskPerformerInviteFailureMsg);

                    errorMsgAlert.removeClass('d-none');
                    errorMsgAlert.find('h4').html(errorMsgContent.html());
                } else {
                    errorMsgAlert.removeClass('d-none');
                    errorMsgAlert.find('h4').text(taskPerformerInviteFailureMsg);
                }

                modalCloseBtn.click();
            }
        });
    }

    let addHandlersToPerformerInviteButtons = function () {
        $('div.candidate-card button.performerInviteBtn').on('click', addPerformerCardIdToInvitationModal);
    }

    $(function () {

        let init = function () {

            addHandlersToPerformerInviteButtons();

            $('#taskInvitePerformerModal a.confirmBtn').on('click', sendTaskPerformerInvitationRequest);
        };

        init();
    });
</script>

</div>


<footer name="footer" class="mt-auto main-footer py-3">
    <div class="container">
        <div class="row">
            <div class="col-md-2">
                <a class="nav-link link"><h5 class="text-white">SKARB NGO</h5></a>
            </div>
            <div class="col-md-3 offset-md-3">
                <a class="nav-link link" href="/feedback">
                    <h5 class="text-white" action="#">Contact us</h5></a>
            </div>
            <div class="col-md-3 offset-md-1">
                <a class="nav-link link">
                    <h5 class="text-white"><i class="fa fa-copyright" aria-hidden="true"></i> 2020 Skarb NGO</h5></a>
            </div>
        </div>
    </div>
</footer>


</body></html>